!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var t=class{constructor(e,t){var s,i;i=()=>this._inputList.some((e=>!e.validity.valid)),(s="_hasInvalidInput")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._inputSelector=e.inputSelector,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._form=t,this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._buttonElement=this._form.querySelector(this._submitButtonSelector)}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)}))}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}};class s{constructor(e,t){let{items:s,renderer:i}=e;this._renderedItems=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._container.append(t)}prepenedItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this.addItem(e)}))}}var i=class{constructor(e){this._popupElement=document.querySelector(`.${e}`),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}},n=class extends i{constructor(e,t,s){super(e),this._handleFormSubmit=s,this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__button"),this._submitButtonText=t,this._popupInputs=this._popupForm.querySelectorAll(".form__input")}_getInputValues(){const e={};return this._popupInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}close(){this._popupForm.reset(),super.close()}showLoading(){this._submitButton.textContent="Saving..."}hideLoading(){this._submitButton.textContent=this._submitButtonText}};const r={inputSelector:".form__input",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled"},o=document.querySelector(".popup_type_edit-profile").querySelector(".form"),a=document.querySelector(".popup_type_add-card").querySelector(".form"),l=document.querySelector(".popup_type_edit-avatar").querySelector(".form"),h=document.querySelector(".profile__button-edit"),c=document.querySelector(".profile__button-add"),d=document.querySelector(".profile__change-avatar-button"),_=document.querySelector(".form__input_content_name"),u=document.querySelector(".form__input_content_job"),p=document.querySelector("#card").content;let m,v;const k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(e.statusText)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"4be499fc-5672-4523-b62c-e8d2a297b26e","Content-Type":"application/json"}}),b=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._about.textContent=s}setAvatar(e){this._avatar.src=e.avatar}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar-img"}),L=(t,s)=>{const i=new class{constructor(t,s,i,n){let{handleCardClick:r,handleDeleteCard:o,handleLikeIcon:a}=i;e(this,"removeCard",(()=>{this._element.remove(),this._element=null})),e(this,"_setEventListeners",(()=>{this._imageElement.addEventListener("click",(()=>this._handleCardClick(this._element))),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon(this._id)})),this._trashButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)}))})),this._title=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteCard=o,this._handleLikeIcon=a,this._userId=n,this._ownerId=t.owner._id}toggleLike(e){this._likeButton.classList.toggle("card__button-like_liked"),this._element.querySelector(".card__likes-count").textContent=e.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}setLikes(e){this._likes=e,this._renderLikes()}_addLike(){this._likeButton.classList.add("card__button-like_liked")}_removeLike(){this._likeButton.classList.remove("card__button-like_liked")}_renderLikes(){this._likesCount.textContent=this._likes.length,this.isLiked()?this._addLike():this._removeLike()}generateCard(){return this._element=this._cardSelector.querySelector(".card").cloneNode(!0),this._likeButton=this._element.querySelector(".card__button-like"),this._imageElement=this._element.querySelector(".card__image"),this._trashButton=this._element.querySelector(".card__button-trash"),this._likesCount=this._element.querySelector(".card__likes-count"),this._cardTitle=this._element.querySelector(".card__title"),this._imageElement.src=this._link,this._imageElement.alt=this._title,this._cardTitle.textContent=this._title,this._likesCount.textContent=this._likes.length,this._setEventListeners(),this._ownerId!==this._userId&&(this._trashButton.style.display="none"),this._renderLikes(),this.isLiked()&&this._addLike(),this._element}}(t,p,{handleCardClick:()=>{y.open(t.name,t.link)},handleDeleteCard:e=>{C.open(),C.setAction((()=>{C.showLoading(),k.deleteCard(e).then((()=>{i.removeCard(),C.close()})).catch((e=>{console.log(e)})).finally((()=>{C.hideLoading()}))}))},handleLikeIcon:e=>{i.isLiked()?k.dislikeCard(e).then((e=>{i.setLikes(e.likes)})).catch((e=>{console.log(e)})):k.likeCard(e).then((e=>{i.setLikes(e.likes)})).catch((e=>{console.log(e)}))}},s);return i.generateCard()};Promise.all([k.getInitialCards(),k.getUserInfo()]).then((e=>{let[t,i]=e;v=i._id,b.setUserInfo({name:i.name,about:i.about}),b.setAvatar({avatar:i.avatar}),m=new s({items:t,renderer:e=>L(e,v)},".gallery"),m.renderItems()})).catch((e=>{console.log(e)}));const g=new n("popup_type_add-card","Save",(e=>(g.showLoading(),k.addCard(e).then((e=>{const t=L(e,v);m.prepenedItem(t),I.toggleButtonState(),g.close()})).catch((e=>{console.log(e)})).finally((()=>{g.hideLoading()})))));g.setEventListeners();const E=new n("popup_type_edit-avatar","Save",(e=>(E.showLoading(),k.editUserAvatar(e.link).then((()=>{b.setAvatar({avatar:e.link}),I.toggleButtonState(),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.hideLoading()})))));E.setEventListeners();const S=new n("popup_type_edit-profile","Save",(e=>{S.showLoading(),k.editUserInfo(e).then((e=>{b.setUserInfo(e),S.close()})).catch((e=>{console.log(e)})).finally((()=>{S.hideLoading()}))}));S.setEventListeners();const y=new class extends i{constructor(e){super(e),this.popUpDescription=this._popupElement.querySelector(".popup__description"),this._image=this._popupElement.querySelector(".popup__image")}open(e,t){this.popUpDescription.textContent=e,this._image.src=t,this._image.alt=e,super.open()}}("popup_type_card");y.setEventListeners();const C=new class extends i{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__button")}showLoading(){this._submitButton.textContent="Removing..."}hideLoading(){this._submitButton.textContent="Yes"}setAction(e){this._submitHandler=e}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}("popup_type_delete-card-form");C.setEventListeners(),h.addEventListener("click",(()=>{const e=b.getUserInfo();var t,s;t=e.name,s=e.about,_.value=t,u.value=s,S.open(),f.resetValidation()})),c.addEventListener("click",(()=>{g.open(),I.resetValidation(),I.toggleButtonState()})),d.addEventListener("click",(()=>{E.open(),q.resetValidation(),q.toggleButtonState()}));const f=new t(r,o);f.enableValidation();const I=new t(r,a);I.enableValidation();const q=new t(r,l);q.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM3QnVMLEVBQTZCMUssbUJBQW1CLElBSWxELE1BQU15SyxFQUEyQixJQUFJRSxFQUNuQ3hILEVBQ0FDLEdBRUZxSCxFQUF5QnBLLG1CQUV6QixNQUFNNkosRUFBd0IsSUFBSVMsRUFDaEN4SCxFQUNBRSxHQUVGNkcsRUFBc0I3SixtQkFFdEIsTUFBTXFLLEVBQStCLElBQUlDLEVBQ3ZDeEgsRUFDQUcsR0FFRm9ILEVBQTZCckssa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlsaXR5L2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbGl0eS9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIHsgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlSWNvbiB9LFxyXG4gICAgdXNlcklkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmVtb3ZlIGNhcmRcclxuICAgKi9cclxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIC8qKlxyXG4gICAqIHRvZ2dsZSBsaWtlIGJ1dHRvblxyXG4gICAqL1xyXG4gIHRvZ2dsZUxpa2UoYW1vdW50TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2J1dHRvbi1saWtlX2xpa2VkXCIpO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50XCIpLnRleHRDb250ZW50ID1cclxuICAgICAgYW1vdW50TGlrZXMubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogY2hlY2sgaWYgaXQgb3VyIGxpa2Ugb3Igbm90XHJcbiAgICovXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChwZXJzb24pID0+IHBlcnNvbi5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzZXQgYW1vdW50IG9mIGxpa2VzIGFuZCByZW5kZXIgaXRcclxuICAgKi9cclxuICBzZXRMaWtlcyhsaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBmaWxsIGxpa2UgaW1hZ2VcclxuICAgKi9cclxuICBfYWRkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2J1dHRvbi1saWtlX2xpa2VkXCIpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBjaGFuZ2Ugb24gcHVyZSBsaWtlIGltYWdlXHJcbiAgICovXHJcbiAgX3JlbW92ZUxpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idXR0b24tbGlrZV9saWtlZFwiKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogcmVuZGVyIGFsbCBpbmZvcm1hdGlvbiBhYm91dCBsaWtlXHJcbiAgICovXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgdGhpcy5fbGlrZXNDb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9hZGRMaWtlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9yZW1vdmVMaWtlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzZXQgYWxsIGxpc3RlbmVycyBvbiB0aGUgY2FyZFxyXG4gICAqL1xyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2VsZW1lbnQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbih0aGlzLl9pZCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogbmV3IGVsZW1lbnQgd2l0aCBjYXJkIGJ5IHRlbXBsYXRlXHJcbiAgICogQHJldHVybnMgb2JqZWN0XHJcbiAgICovXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2NhcmRTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b24tbGlrZVwiKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvbi10cmFzaFwiKTtcclxuICAgIHRoaXMuX2xpa2VzQ291bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZXMtY291bnRcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcblxyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuICAgIHRoaXMuX2xpa2VzQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fdHJhc2hCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5fYWRkTGlrZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcclxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNob3cgZXJyb3JcclxuICAgKiBAcGFyYW0ge29iamVjdH0gaW5wdXRFbGVtZW50XHJcbiAgICovXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBoaWRlIGVycm9yXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IGlucHV0RWxlbWVudFxyXG4gICAqL1xyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHNob3cgb3IgaGlkZSBlcnJvclxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dEVsZW1lbnRcclxuICAgKi9cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBjaGVja2luZyBhbGwgZmllbGRzIGZvciB2YWxpZGl0eVxyXG4gICAqIEByZXR1cm5zIGJvb2xlYW5cclxuICAgKi9cclxuICBfaGFzSW52YWxpZElucHV0ID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9O1xyXG5cclxuICAvKipcclxuICAgKiB0b29nbGUgYnV0dG9uIHN0YXRlXHJcbiAgICovXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc2V0IGFsbCBsaXN0ZW5lcnMgb24gdGhlIGNhcmRcclxuICAgKi9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzdGFydCB2YWxpZGF0aW9uXHJcbiAgICovXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuXHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcbiAgXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGNhcmQpO1xyXG4gIH1cclxuICBwcmVwZW5lZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLmFkZEl0ZW0oaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvciAocG9wdXBTZWxlY3Rvcil7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtwb3B1cFNlbGVjdG9yfWApO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCl7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpe1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXAnKSB8fCBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlJykpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwOyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLHN1Ym1pdEJ1dHRvblRleHQsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSBzdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5fcG9wdXBJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xyXG4iLCJjb25zdCBjb25maWdDbGFzc2VzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG59O1xyXG4vL1dyYXBwZXJzXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIpO1xyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1FbGVtZW50ID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdC1hdmF0YXJcIik7XHJcbmNvbnN0IGVkaXRBdmF0YXJFbGVtZW50ID0gZWRpdEF2YXRhckNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG4vL0J1dHRvbnNcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWVkaXRcIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWFkZFwiKTtcclxuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fY2hhbmdlLWF2YXRhci1idXR0b25cIlxyXG4pO1xyXG5cclxuLy9JbnB1dHNcclxuY29uc3QgbmFtZUVkaXRQcm9maWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX2lucHV0X2NvbnRlbnRfbmFtZVwiXHJcbik7XHJcbmNvbnN0IGpvYkVkaXRQcm9maWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X2NvbnRlbnRfam9iXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkXCIpLmNvbnRlbnQ7XHJcblxyXG5leHBvcnQge1xyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdFByb2ZpbGVNb2RhbCxcclxuICBlZGl0Rm9ybUVsZW1lbnQsXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudCxcclxuICBlZGl0QXZhdGFyQ2FyZE1vZGFsLFxyXG4gIGVkaXRBdmF0YXJFbGVtZW50LFxyXG4gIGVkaXRQcm9maWxlTW9kYWxCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsQnV0dG9uLFxyXG4gIGVkaXRBdmF0YXJCdXR0b24sXHJcbiAgbmFtZUVkaXRQcm9maWxlSW5wdXQsXHJcbiAgam9iRWRpdFByb2ZpbGVJbnB1dCxcclxuICBjYXJkVGVtcGxhdGVcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjsgLy8gYWRkIGltcG9ydCBvZiB0aGUgbWFpbiBzdHlsZXNoZWV0cyBmaWxlXHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxpdHkvQXBpLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdEZvcm1FbGVtZW50LFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudCxcclxuICBlZGl0QXZhdGFyRWxlbWVudCxcclxuICBlZGl0UHJvZmlsZU1vZGFsQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbEJ1dHRvbixcclxuICBlZGl0QXZhdGFyQnV0dG9uLFxyXG4gIG5hbWVFZGl0UHJvZmlsZUlucHV0LFxyXG4gIGpvYkVkaXRQcm9maWxlSW5wdXQsXHJcbiAgY2FyZFRlbXBsYXRlXHJcbn0gZnJvbSBcIi4uL3V0aWxpdHkvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5sZXQgY2FyZHM7XHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCBmaWxsRWRpdFByb2ZpbGVGb3JtID0gKG5hbWUsIGFib3V0KSA9PiB7XHJcbiAgbmFtZUVkaXRQcm9maWxlSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIGpvYkVkaXRQcm9maWxlSW5wdXQudmFsdWUgPSBhYm91dDtcclxufTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tQVBJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjRiZTQ5OWZjLTU2NzItNDUyMy1iNjJjLWU4ZDJhMjk3YjI2ZVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBGaWxsIGRhdGEgaW4gZWRpdFByb2ZpbGVNb2NrdXBcclxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcclxuICogQHBhcmFtIHtzdHJpbmd9IGpvYlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gYXZhdGFyXHJcbiAqL1xyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXItaW1nXCIsXHJcbn0pO1xyXG4vKipcclxuICogR2VuZXJhdGUgbmV3IGNhcmRcclxuICogQHBhcmFtIHtPYmplY3R9IGNhcmRPYmplY3RcclxuICogQHJldHVybnMgT2JqZWN0XHJcbiAqL1xyXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmRPYmplY3QsIHVzZXJJZCkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmRPYmplY3QsXHJcbiAgICBjYXJkVGVtcGxhdGUsXHJcbiAgICB7XHJcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xyXG4gICAgICAgIGltYWdlTW9kYWwub3BlbihjYXJkT2JqZWN0Lm5hbWUsIGNhcmRPYmplY3QubGluayk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChpZCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Nb2RhbC5vcGVuKCk7XHJcbiAgICAgICAgY29uZmlybU1vZGFsLnNldEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgICBjb25maXJtTW9kYWwuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAuZGVsZXRlQ2FyZChpZClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgICBjb25maXJtTW9kYWwuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUxpa2VJY29uOiAoaWQpID0+IHtcclxuICAgICAgICBjb25zdCBpc0FscmVhZHlMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xyXG4gICAgICAgIGlmIChpc0FscmVhZHlMaWtlZCkge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kaXNsaWtlQ2FyZChpZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5saWtlQ2FyZChpZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgdXNlcklkXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufTtcclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VySW5mbygpXSkudGhlbigoW2l0ZW1zLCB1c2VyRGF0YV0pID0+IHtcclxuICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiB1c2VyRGF0YS5uYW1lLCBhYm91dDogdXNlckRhdGEuYWJvdXQgfSk7XHJcbiAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIgfSk7XHJcbiAgY2FyZHMgPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgaXRlbXM6IGl0ZW1zLFxyXG4gICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSwgdXNlcklkKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgXCIuZ2FsbGVyeVwiXHJcbiAgKTtcclxuICBjYXJkcy5yZW5kZXJJdGVtcygpO1xyXG59KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgY29uc29sZS5sb2coZXJyKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGROZXdDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcInBvcHVwX3R5cGVfYWRkLWNhcmRcIixcclxuICBcIlNhdmVcIixcclxuICAoZGF0YSkgPT4ge1xyXG4gICAgYWRkTmV3Q2FyZE1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQocmVzLCB1c2VySWQpO1xyXG4gICAgICAgIGNhcmRzLnByZXBlbmVkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgYWRkTmV3Q2FyZE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGFkZE5ld0NhcmRNb2RhbC5oaWRlTG9hZGluZygpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcbmFkZE5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCJwb3B1cF90eXBlX2VkaXQtYXZhdGFyXCIsXHJcbiAgXCJTYXZlXCIsXHJcbiAgKGRhdGEpID0+IHtcclxuICAgIGVkaXRBdmF0YXJNb2RhbC5zaG93TG9hZGluZygpO1xyXG4gICAgcmV0dXJuIGFwaVxyXG4gICAgICAuZWRpdFVzZXJBdmF0YXIoZGF0YS5saW5rKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHsgYXZhdGFyOiBkYXRhLmxpbmsgfSk7XHJcbiAgICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgZWRpdEF2YXRhck1vZGFsLmNsb3NlKClcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgZWRpdEF2YXRhck1vZGFsLmhpZGVMb2FkaW5nKCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuKTtcclxuZWRpdEF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0TW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcInBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgXCJTYXZlXCIsXHJcbiAgKGRhdGEpID0+IHtcclxuICAgIGVkaXRNb2RhbC5zaG93TG9hZGluZygpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5lZGl0VXNlckluZm8oZGF0YSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGVkaXRNb2RhbC5oaWRlTG9hZGluZygpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbik7XHJcbmVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcInBvcHVwX3R5cGVfY2FyZFwiKTtcclxuaW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBjb25maXJtTW9kYWwgPSBuZXcgUG9wdXBXaXRoU3VibWl0KFwicG9wdXBfdHlwZV9kZWxldGUtY2FyZC1mb3JtXCIpO1xyXG5jb25maXJtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG5lZGl0UHJvZmlsZU1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZmlsbEVkaXRQcm9maWxlRm9ybShkYXRhLm5hbWUsIGRhdGEuYWJvdXQpO1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmFkZENhcmRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZE5ld0NhcmRNb2RhbC5vcGVuKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdGlvbi50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJNb2RhbC5vcGVuKCk7XHJcbiAgZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0QXZhdGFyQ2FyZEZvcm1WYWxpZGF0aW9uLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn0pO1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVZhbGlkYXRpb24tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdEZvcm1FbGVtZW50XHJcbik7XHJcbmVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWdDbGFzc2VzLFxyXG4gIGFkZENhcmRGb3JtRWxlbWVudFxyXG4pO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ0NsYXNzZXMsXHJcbiAgZWRpdEF2YXRhckVsZW1lbnRcclxuKTtcclxuZWRpdEF2YXRhckNhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBnZXQgaW5mbyBhYm91dCB1c2VyIGZyb20gc2VydmVyXHJcbiAgICogQHJldHVybnMgT2JqZWN0XHJcbiAgICovXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuICBlZGl0VXNlckluZm8obmV3VXNlckluZm8pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KG5ld1VzZXJJbmZvKSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZChuZXdDYXJkSW5mbykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShuZXdDYXJkSW5mbyksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7bmFtZSwgYWJvdXR9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG4gIHNldEF2YXRhcihhdmF0YXJMaW5rKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyTGluay5hdmF0YXI7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMucG9wVXBEZXNjcmlwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cF9fZGVzY3JpcHRpb25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gIH1cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMucG9wVXBEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKXtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJSZW1vdmluZy4uLlwiO1xyXG4gIH1cclxuXHJcblxyXG4gIGhpZGVMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJZZXNcIjtcclxuICB9XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhTdWJtaXQ7XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0TGlzdCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfZm9ybSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnV0dG9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZG9jdW1lbnQiLCJhZGRJdGVtIiwiaXRlbSIsImNhcmQiLCJhcHBlbmQiLCJwcmVwZW5lZEl0ZW0iLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJldnQiLCJrZXkiLCJjbG9zZSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwic3VibWl0QnV0dG9uVGV4dCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwRm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9wb3B1cElucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwibmFtZSIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwiY29uZmlnQ2xhc3NlcyIsImVkaXRGb3JtRWxlbWVudCIsImFkZENhcmRGb3JtRWxlbWVudCIsImVkaXRBdmF0YXJFbGVtZW50IiwiZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbiIsImFkZENhcmRNb2RhbEJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJuYW1lRWRpdFByb2ZpbGVJbnB1dCIsImpvYkVkaXRQcm9maWxlSW5wdXQiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiY2FyZHMiLCJ1c2VySWQiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0VXNlckluZm8iLCJuZXdVc2VySW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsIm5ld0NhcmRJbmZvIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJlZGl0VXNlckF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZSIsIl9hYm91dCIsIl9hdmF0YXIiLCJhYm91dCIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiYXZhdGFyTGluayIsInNyYyIsImNyZWF0ZUNhcmQiLCJjYXJkT2JqZWN0IiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlSWNvbiIsIl9lbGVtZW50IiwiX2ltYWdlRWxlbWVudCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfbGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlSWNvbiIsIl9pZCIsIl90cmFzaEJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX3RpdGxlIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJ0b2dnbGVMaWtlIiwiYW1vdW50TGlrZXMiLCJ0b2dnbGUiLCJsZW5ndGgiLCJpc0xpa2VkIiwicGVyc29uIiwic2V0TGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJfYWRkTGlrZSIsIl9yZW1vdmVMaWtlIiwiX2xpa2VzQ291bnQiLCJnZW5lcmF0ZUNhcmQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiaW1hZ2VNb2RhbCIsImNvbmZpcm1Nb2RhbCIsInNldEFjdGlvbiIsInJlbW92ZUNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwiYWxsIiwidXNlckRhdGEiLCJhZGROZXdDYXJkTW9kYWwiLCJQb3B1cFdpdGhGb3JtIiwiY2FyZEVsZW1lbnQiLCJhZGRDYXJkRm9ybVZhbGlkYXRpb24iLCJlZGl0QXZhdGFyTW9kYWwiLCJlZGl0TW9kYWwiLCJwb3BVcERlc2NyaXB0aW9uIiwiX2ltYWdlIiwiYWN0aW9uIiwiX3N1Ym1pdEhhbmRsZXIiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyQ2FyZEZvcm1WYWxpZGF0aW9uIiwiRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=